# 実装タスクリスト

## セクション1：データモデル実装
- [x] 1.1 入力状態の型定義を追加する
  - `InputState`の型定義
  - 選択許可フラグの扱いを整理する
- [x] 1.2 データ永続化層を実装する
  - 永続化は行わないため不要であることを確認する

## セクション2：ビジネスロジック実装
- [x] 2.1 CanvasViewportの入力処理を更新する
  - 二本指スクロールをパンに変換する
  - ホイールズームを無効化する
  - Commandキー押下中のドラッグでキャンバスを移動できるようにする
- [x] 2.2 選択抑制の制御を実装する
  - 通常ドラッグ時の`user-select`無効化
  - テキストを直接選択した場合のみ選択を許可する
- [x] 2.3 エラーハンドリングを実装する
  - 入力処理失敗時に状態を維持する
  - 変換値を常にクランプする

## セクション3：インターフェース実装
- [x] 3.1 固定UIの配置を更新する
  - ヘッダーとブランチ一覧をキャンバス外に配置
- [x] 3.2 入力バリデーションを実装する
  - パン/ズームの範囲制約を維持する
- [x] 3.3 出力フォーマットを実装する
  - 固定UIの表示位置を維持する

## セクション4：統合とテスト
- [x] 4.1 既存ページに統合する
  - `ChatCanvasShell`と`CanvasViewport`の接続確認
- [x] 4.2 基本的な動作テストを実装する
  - 二本指パンとピンチズームの挙動を検証
  - Commandキー押下中のドラッグでキャンバス移動できることを検証
  - テキスト直接選択のみ許可されることを検証
- [x] 4.3 要件の受入基準を満たすことを確認する
  - 固定UIが動かず、操作要件が満たされていることを確認
